#연습문제 10.2
x1 <- c(61,72,85,84,98,53,54,89,77,88,76,59,91,65,81,51)
x2 <- c(0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1) #A=0,B=1
y <- c(18,17.4,14.5,14,13.4,24.4,22.7,12.7,27.1,25.4,33.5,35.6,26.1,36.8,34.9,43.6)
x12 <- x1*x2 #교호작용

fit1 <- lm(y~x1+x2)
summary(fit1)
#y = 39.76136 + -0.30368x1 + 15.43382

anova(fit1)
F0 = ((353.82 + 951.70)/2) / 7.51
F0

#교호작용이 없는 선형회귀모형 yj=B0+B1x1+B2x2+£에서는 F0 = 86.91 > F(2,13,0.05) = 3.68이므로 y와 x1,x2간 관계가 매우 유의하게 나왔다. 예제 10.2에서는 교호작용 효과가 유의하지 않게 판정되었으므로 선형회귀모형을 적합하는것이 바람직하다.


#연습문제 10.4
#(1)
x1 <- c(2.5,4.4,4.5,1.4,4.7,3.5,2.5,3.8)
y <- c(65,34,40,80,30,57,72,48)
plot(x1,y)
#기울기가 급격히 바뀌는 x=3.8을 기준으로 2개 구간으로 나누는게 적당해보인다.

#(2)
funcx2 <- function(x1)
ifelse(x1>3.8,1,0)
x2 <- (x1-3.8)*funcx2(x1)
x2

fit <- lm(y~x1+x2)
summary(fit)
#y=99.333 - 12.765x1 - 9.173x2

#(3)
anova(fit)
#H0: B2 = 0, H1: B2 ≠ 0일 때, H0: B2 = 0에 대한 검정의 유의확률이 0.1991로 0.05보다 크기 때문에 H0를 채택한다.

#연습문제 10.5
#(1)
y <- c(15,16,18,13,19,16,15,16,17,15,16,17,18,17,15,15,15,18,17,16,18,17,18,19,20,16,15,19,18,16,19,21,22,23,20,18,20,21,22,19,20,19,21,18,19,17,18,21,20,17,24,25,23,25,25,23,24,22,26,24)
x1 <- c(5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20)
x2 <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) #0=A,1=B

#(2)
fit1 <- lm(y~x1+x2)
anova(fit1)

#(3)
summary(fit1)
#y=15.73333 + 0.14x1 + 3.13333x2

#(4)
x1x2 <- x1*x2
fit2 <- lm(y~x1+x2+x1x2)
anova(fit2)
#H0: B3(교호작용) = 0, H1: B3 ≠ 0일 때, H0: B3 = 0에 대한 검정의 유의확률이 0.1991로 0.05보다 크기 때문에 H0를 채택한다.

#연습문제 10.7
x=c(1,2,3,4,5,6)
n=c(250,252,151,204,202,195)
R=c(15,20,18,25,32,40)
p=R/n
p
p2=log(p/(1-p))
p2 #로지스틱 변환비율

#(1)
fit <- lm(p2~x)
summary(fit)
#y= -2.968 + 0.267x

#(2)
#x = 전학생 수라 가정,
x=4
(y= -2.968 + 0.267*x)
originalphat=exp(-1.9)/(1+exp(-1.9))
originalphat

#(3)
#phat*= -2.968 + 0.267x
#종속변수(안경을 썼는지 여부)가 지시변수로 변환되고, 이때의 반응변수 E(y)가 0<=E(y)<=1을 만족하므로 타당하다.